<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.weichai.modules.statistics.dao.CodeMaterialDao">

	<select id="getSupplierList" resultType="CodeMaterialInfo">
		select
		DISTINCT SUPPLIER_NAME AS supplierName
		from MATERIAL
	</select>

	<select id="queryCodeMaterialList" parameterType="CodeMaterialInfo" resultType="CodeMaterialInfo">
		select
		SUPPLIER_NAME as supplierName,
		SHIPPING_ORDER as shippingOrder,
		MATERIAL_CODE as materialCode,
		MATERIAL_NAME as materialName,
		PRODUCT_ID_NUM as productIdNum,
		W_ID_NUM as outCodeNum,
		SECURITY_NUM as securityNum,
		count(PRODUCT_ID) as realProductIdNum,
		count(W_ID) as realOutCodeNum,
		count(SECURITY) as realSecurityNum
		from MATERIAL
		<where>
			<if test="supplierName!=null and supplierName !=''">
				SUPPLIER_NAME LIKE '%'||#{supplierName}||'%'
			</if>
			<if test="startTime!=null">
				<![CDATA[  AND  trunc(SHIPPING_TIME) >= #{startTime}  ]]>
			</if>
			<if test="endTime !=null">
				<![CDATA[  AND  trunc(SHIPPING_TIME) <= #{endTime}  ]]>
			</if>
		</where>
		GROUP BY SUPPLIER_NAME,SHIPPING_ORDER,MATERIAL_CODE,MATERIAL_NAME,PRODUCT_ID_NUM,W_ID_NUM,SECURITY_NUM
	</select>

</mapper>

