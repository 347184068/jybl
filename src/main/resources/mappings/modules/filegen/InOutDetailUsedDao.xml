<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.weichai.modules.filegen.dao.InOutDetailUsedDao">
	<sql id="inOutDetailUsedColumns">
		a.ID as id,
		a.N_ID as inCode,
		a.W_ID as outCode,
		a.CREATE_BY as createBy,
		a.CREATE_DATE as createDate,
		a.UPDATE_BY as updateBy,
		a.UPDATE_DATE as updateDate,
		a.REMARKS as remarks,
		a.STATUS as status,
		a.IMT_STATUS AS imtStatus,
		a.TYPE AS s,
		a.BAOCAI_TYPE as baoCaiType
	</sql>

	<insert id="batchInsertInOutDetail" parameterType="java.util.List">
		INSERT ALL
		<foreach collection ="list" item="item" index= "index">
		INTO in_out_detail_used
		VALUES
		(
			#{item.id},
			#{item.n},
			#{item.w},
			#{item.createBy},
			SYSDATE,
			#{item.updateBy},
			#{item.updateDate},
			#{item.remarks},
			#{item.status},
			#{item.imtStatus},
			#{item.s},
			#{item.baoCaiType}
		)
		</foreach>
		SELECT 1 FROM DUAL
	</insert>
	<select id="batchSave" parameterType="java.util.List">
		INSERT INTO in_out_detail_used(ID,N_ID,W_ID,CREATE_BY,CREATE_DATE,UPDATE_BY,UPDATE_DATE,REMARKS,STATUS,IMT_STATUS,TYPE,BAOCAI_TYPE)
		<foreach collection ="list" item="item" separator="union all">
			(SELECT #{item.id},
			#{item.n},
			#{item.w},
			#{item.createBy},
			SYSDATE,
			#{item.updateBy},
			#{item.updateDate},
			#{item.remarks},
			#{item.status},
			#{item.imtStatus},
			#{item.s},
			#{item.baoCaiType}
			FROM DUAL)
		</foreach>
	</select>

	<select id="selectInOutDetailUsedList" resultType="ImtOiValidCode">
		SELECT
		 a.ID AS id,
		 a.N_ID as inCode,
		 a.W_ID as outCode
		 FROM in_out_detail_used a
		 WHERE a.IMT_STATUS = 0 and a.TYPE = 1
	</select>

	<update id="batchUpdateImtStatus" parameterType="java.util.List">
		BEGIN
		<foreach collection="list" item="item" index="index" separator=";">
			update in_out_detail_used
			<set>
				IMT_STATUS = 1
			</set>
			where ID =#{item.id}
		</foreach>
		;END ;
	</update>

	<update id="update" parameterType="ImtOiValidCode">
		update in_out_detail_used
		<set>
			IMT_STATUS = 1
		</set>
		where ID = #{id}
	</update>

	<!--<update id="batchUpdateImtStatus" parameterType="java.util.List">
			update in_out_detail_used
			<set>
				IMT_STATUS = 1
			</set>
			where ID IN
			<foreach collection="list" item="item" index="index"   separator=",">
				${item.id}
		</foreach>
	</update>-->


	<select id="batchSaveFailCode" parameterType="java.util.List">
		INSERT INTO IN_OUT_DETAIL_USED_FAIL(ID,N_ID,W_ID,CREATE_BY,CREATE_DATE,UPDATE_BY,UPDATE_DATE,REMARKS,STATUS,IMT_STATUS,TYPE,BAOCAI_TYPE)
		<foreach collection ="list" item="item" separator="union all">
			(SELECT #{item.id},
			#{item.n},
			#{item.w},
			#{item.createBy},
			SYSDATE,
			#{item.updateBy},
			#{item.updateDate},
			#{item.remarks},
			#{item.status},
			#{item.imtStatus},
			#{item.s},
			#{item.baoCaiType}
			FROM DUAL)
		</foreach>
	</select>
</mapper>

